"use strict";function addNewInput(e){e.insertAdjacentHTML("beforebegin",'<div class="input-group input-group-sm mb-1">\n    <input type="text" name="keywords[]" class="form-control form-control-sm">\n        <div class="input-group-append">\n            <button class="btn btn-sm btn-outline-danger btn-remove" type="button">\n                <span class="oi oi-x"></span>\n            </button>\n        </div>\n    </div>'),e.previousSibling.querySelector(".btn-remove").addEventListener("click",function(){removeSecondParent(this)}),e.previousSibling.querySelector("input").addEventListener("keyup",function(e){clickButton(e)})}function clickButton(e){e.preventDefault(),13===e.keyCode&&document.querySelector("#add-new-keyword").click()}function getNameById(e,t){var n=e.filter(function(e){return e.id==t});return 0!=n.length&&n[0].name}function removeSecondParent(e){e.parentNode.parentNode.parentNode.removeChild(e.parentNode.parentNode)}var columns;document.getElementById("letter-form")&&(new Vue({el:"#letter-form",data:{author:"",recipient:"",origin:"",destination:"",day:"",month:"",year:"",title:"",persons:JSON.parse(document.querySelector("#people").innerHTML),places:JSON.parse(document.querySelector("#places").innerHTML)},methods:{getTitle:function(){var e=getNameById(this.persons,this.author),t=getNameById(this.persons,this.recipient),n=getNameById(this.places,this.origin),o=getNameById(this.places,this.destination),a=this.day+". "+this.month+". "+this.year,r=e+" ("+n+")",l=t+" ("+o+")";this.title=a+" "+r+" to "+l},regenerateSelectData:function(e){var t=e.target.dataset.source,n=this;"persons"==t&&(e.target.classList.add("rotate"),axios.get(ajaxUrl+"?action=list_bl_people_simple").then(function(e){n.persons=e.data}).catch(function(e){console.log(e)}).then(function(){e.target.classList.remove("rotate")}))}}}),Array.prototype.forEach.call(document.querySelectorAll(".slim-select"),function(e){e.id&&new SlimSelect({select:"#"+e.id})})),document.getElementById("places-form")&&Array.prototype.forEach.call(document.querySelectorAll(".slim-select"),function(e){e.id&&new SlimSelect({select:"#"+e.id})}),document.getElementById("person-name")&&new Vue({el:"#person-name",data:{firstName:"",lastName:""},computed:{fullName:function(){var e;return e=this.capitalize(this.lastName).trim()+", "+this.capitalize(this.firstName).trim(),e.trim()},personsFormValidated:function(){return!(""==this.firstName||""==this.lastName||this.fullName.length<8)}},methods:{capitalize:function(e){return e.charAt(0).toUpperCase()+e.slice(1)}}}),document.getElementById("add-new-keyword")&&document.querySelector("#add-new-keyword").addEventListener("click",function(){addNewInput(this)}),document.querySelector(".keywords input")&&document.querySelector(".keywords input").addEventListener("keyup",function(e){clickButton(e)});var tabledata,defaultTablesOptions={skin:"table table-bordered table-hover table-striped table-sm",sortIcon:{base:"oi pl-1",up:"oi-arrow-top",down:"oi-arrow-bottom",is:"oi-elevator"},texts:{count:"Zobrazena položka {from} až {to} z celkového počtu {count} položek |{count} položky|Jedna položka",first:"První",last:"Poslední",filter:"Filtr: ",filterPlaceholder:"Hledat",limit:"Položky: ",page:"Strana: ",noResults:"Nenalezeno",filterBy:"Filtrovat dle {column}",loading:"Načítá se...",defaultOption:"Vybrat {column}",columns:"Columns"}};document.getElementById("datatable-letters")&&(tabledata=null!==document.querySelector("#letters-data")?JSON.parse(document.querySelector("#letters-data").innerHTML):null,Vue.use(VueTables.ClientTable,!1,!1,"bootstrap4"),columns=["edit","number","date","author","recipient","origin","dest","status"],new Vue({el:"#datatable-letters",data:{columns:columns,tableData:tabledata,options:{headings:{edit:"Akce",dest:"Destination"},skin:defaultTablesOptions.skin,sortable:removeElFromArr("edit",columns),filterable:removeElFromArr("edit",columns),sortIcon:defaultTablesOptions.sortIcon,texts:defaultTablesOptions.texts,dateColumns:["date"],rowClassCallback:function(e){return"row-"+e.id}}},methods:{deleteLetter:function(t){Swal.fire({title:"Opravdu chcete smazat tento dopis?",type:"warning",buttonsStyling:!1,showCancelButton:!0,confirmButtonText:"Ano!",cancelButtonText:"Zrušit",confirmButtonClass:"btn btn-primary btn-lg mr-1",cancelButtonClass:"btn btn-secondary btn-lg ml-1"}).then(function(e){e.value&&axios.get(ajaxUrl+"?action=delete_bl_letter&pods_id="+t).then(function(){Swal.fire({title:"Odstraněno.",type:"success",buttonsStyling:!1,confirmButtonText:"OK",confirmButtonClass:"btn btn-primary btn-lg"}),document.querySelector("#datatable-letters .row-"+t).classList.add("d-none")}).catch(function(e){Swal.fire({title:"Při odstraňování dopisu došlo k chybě.",text:e,type:"error",buttonsStyling:!1,confirmButtonText:"OK",confirmButtonClass:"btn btn-primary btn-lg"})})})}}}));function removeElFromArr(t,e){return e.filter(function(e){return e!=t})}document.getElementById("datatable-persons")&&(Vue.use(VueTables.ClientTable,!1,!1,"bootstrap4"),columns=["edit","name","dates"],new Vue({el:"#datatable-persons",data:{columns:columns,tableData:JSON.parse(document.querySelector("#persons-data").innerHTML),options:{headings:{edit:"Akce"},skin:defaultTablesOptions.skin,sortable:removeElFromArr("edit",columns),filterable:removeElFromArr("edit",columns),sortIcon:defaultTablesOptions.sortIcon,texts:defaultTablesOptions.texts}}})),document.getElementById("datatable-places")&&(Vue.use(VueTables.ClientTable,!1,!1,"bootstrap4"),columns=["edit","city","country"],new Vue({el:"#datatable-places",data:{columns:columns,tableData:JSON.parse(document.querySelector("#places-data").innerHTML),options:{headings:{edit:"Akce"},skin:defaultTablesOptions.skin,sortable:removeElFromArr("edit",columns),filterable:removeElFromArr("edit",columns),sortIcon:defaultTablesOptions.sortIcon,texts:defaultTablesOptions.texts}}}));