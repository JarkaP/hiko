"use strict";function addNewInput(t){t.insertAdjacentHTML("beforebegin",'<div class="input-group input-group-sm mb-1">\n    <input type="text" name="keywords[]" class="form-control form-control-sm">\n        <div class="input-group-append">\n            <button class="btn btn-sm btn-outline-danger btn-remove" type="button">\n                <span class="oi oi-x"></span>\n            </button>\n        </div>\n    </div>'),t.previousSibling.querySelector("input").focus(),t.previousSibling.querySelector(".btn-remove").addEventListener("click",function(){removeSecondParent(this)}),t.previousSibling.querySelector("input").addEventListener("keyup",function(t){clickButton(t)})}function clickButton(t){t.preventDefault(),13===t.keyCode&&document.querySelector("#add-new-keyword").click()}function getNameById(t,e){var n=t.filter(function(t){return t.id==e});return 0!=n.length&&n[0].name}function removeSecondParent(t){t.parentNode.parentNode.parentNode.removeChild(t.parentNode.parentNode)}var columns;document.getElementById("letter-form")&&(new Vue({el:"#letter-form",data:{author:[],recipient:[],origin:"",destination:"",day:"",month:"",year:"",title:"",persons:JSON.parse(document.querySelector("#people").innerHTML),places:JSON.parse(document.querySelector("#places").innerHTML)},methods:{getTitle:function(){for(var t=[],e=[],n=0;n<this.author.length;n++)t.push(getNameById(this.persons,this.author[n]));for(var a=0;a<this.recipient.length;a++)e.push(getNameById(this.persons,this.recipient[a]));var o=getNameById(this.places,this.origin),r=getNameById(this.places,this.destination),l=this.day+". "+this.month+". "+this.year,i=t.join("; ")+" ("+o+")",s=e+" ("+r+")";this.title=l+" "+i+" to "+s},getInitialData:function(t){var e=this;axios.get(ajaxUrl+"?action=list_public_bl_letters_single&pods_id="+t).then(function(t){"404"==t.data?e.error=!0:console.log(t.data)}).catch(function(){e.error=!0})},ajaxToData:function(t,e,n){var a=this;n.classList.add("rotate"),axios.get(ajaxUrl+"?action="+t).then(function(t){a[e]=t.data}).catch(function(t){console.log(t)}).then(function(){n.classList.remove("rotate")})},regenerateSelectData:function(t){var e=t.target.dataset.source;"persons"==e?this.ajaxToData("list_bl_people_simple","persons",t.target):"places"==e&&this.ajaxToData("list_bl_places_simple","places",t.target)}},mounted:function(){var t=new URL(window.location.href);t.searchParams.get("edit")&&this.getInitialData(t.searchParams.get("edit"))}}),Array.prototype.forEach.call(document.querySelectorAll(".slim-select"),function(t){t.id&&new SlimSelect({select:"#"+t.id})})),document.getElementById("places-form")&&(new Vue({el:"#places-form",data:{place:"",country:""},methods:{getInitialData:function(t){var e=this;axios.get(ajaxUrl+"?action=list_bl_place_single&pods_id="+t).then(function(t){"404"==t.data?e.error=!0:(e.place=t.data.name,e.country=t.data.country)}).catch(function(){e.error=!0})}},mounted:function(){var t=new URL(window.location.href);t.searchParams.get("edit")&&this.getInitialData(t.searchParams.get("edit"))}}),Array.prototype.forEach.call(document.querySelectorAll(".slim-select"),function(t){t.id&&new SlimSelect({select:"#"+t.id})})),document.getElementById("person-name")&&new Vue({el:"#person-name",data:{firstName:"",lastName:"",emlo:"",dob:"",dod:"",error:!1},computed:{fullName:function(){var t;return t=this.capitalize(this.lastName).trim()+", "+this.capitalize(this.firstName).trim(),t.trim()},personsFormValidated:function(){return!(""==this.firstName||""==this.lastName||this.fullName.length<8)}},methods:{capitalize:function(t){return t.charAt(0).toUpperCase()+t.slice(1)},getInitialData:function(t){var e=this;axios.get(ajaxUrl+"?action=list_bl_people_single&pods_id="+t).then(function(t){"404"==t.data?e.error=!0:(e.firstName=t.data.forename,e.lastName=t.data.surname,e.emlo=t.data.emlo,e.dob=t.data.birth_year,e.dod=t.data.death_year)}).catch(function(t){e.error=!0,console.log(t)})}},mounted:function(){var t=new URL(window.location.href);t.searchParams.get("edit")&&this.getInitialData(t.searchParams.get("edit"))}}),document.getElementById("add-new-keyword")&&document.querySelector("#add-new-keyword").addEventListener("click",function(){addNewInput(this)}),document.querySelector(".keywords input")&&document.querySelector(".keywords input").addEventListener("keyup",function(t){clickButton(t)});var tabledata,defaultTablesOptions={skin:"table table-bordered table-hover table-striped table-sm",sortIcon:{base:"oi pl-1",up:"oi-arrow-top",down:"oi-arrow-bottom",is:"oi-elevator"},texts:{count:"Zobrazena položka {from} až {to} z celkového počtu {count} položek |{count} položky|Jedna položka",first:"První",last:"Poslední",filter:"Filtr: ",filterPlaceholder:"Hledat",limit:"Položky: ",page:"Strana: ",noResults:"Nenalezeno",filterBy:"Filtrovat dle {column}",loading:"Načítá se...",defaultOption:"Vybrat {column}",columns:"Columns"}};document.getElementById("datatable-letters")&&(tabledata=null!==document.querySelector("#letters-data")?JSON.parse(document.querySelector("#letters-data").innerHTML):null,Vue.use(VueTables.ClientTable,!1,!1,"bootstrap4"),columns=["edit","number","date","author","recipient","origin","dest","status"],new Vue({el:"#datatable-letters",data:{columns:columns,tableData:tabledata,options:{headings:{edit:"Akce",dest:"Destination"},skin:defaultTablesOptions.skin,sortable:removeElFromArr("edit",columns),filterable:removeElFromArr("edit",columns),sortIcon:defaultTablesOptions.sortIcon,texts:defaultTablesOptions.texts,dateColumns:["date"],rowClassCallback:function(t){return"row-"+t.id}}},methods:{deleteLetter:function(t){var e=this;removeItemAjax(t,"delete_bl_letter",function(){e.deleteRow(t,e.tableData)})},deleteRow:function(e,t){this.tableData=t.filter(function(t){return t.id!==e})}}}));function removeElFromArr(e,t){return t.filter(function(t){return t!=e})}function removeItemAjax(e,n,a){Swal.fire({title:"Opravdu chcete smazat tuto položku?",type:"warning",buttonsStyling:!1,showCancelButton:!0,confirmButtonText:"Ano!",cancelButtonText:"Zrušit",confirmButtonClass:"btn btn-primary btn-lg mr-1",cancelButtonClass:"btn btn-secondary btn-lg ml-1"}).then(function(t){t.value&&axios.get(ajaxUrl+"?action="+n+"&pods_id="+e).then(function(){Swal.fire({title:"Odstraněno.",type:"success",buttonsStyling:!1,confirmButtonText:"OK",confirmButtonClass:"btn btn-primary btn-lg"}),a()}).catch(function(t){Swal.fire({title:"Při odstraňování došlo k chybě.",text:t,type:"error",buttonsStyling:!1,confirmButtonText:"OK",confirmButtonClass:"btn btn-primary btn-lg"})})})}document.getElementById("datatable-persons")&&(Vue.use(VueTables.ClientTable,!1,!1,"bootstrap4"),columns=["edit","name","dates"],new Vue({el:"#datatable-persons",data:{columns:columns,tableData:JSON.parse(document.querySelector("#persons-data").innerHTML),options:{headings:{edit:"Akce"},skin:defaultTablesOptions.skin,sortable:removeElFromArr("edit",columns),filterable:removeElFromArr("edit",columns),sortIcon:defaultTablesOptions.sortIcon,texts:defaultTablesOptions.texts,rowClassCallback:function(t){return"row-"+t.id}}},methods:{deletePerson:function(t){var e=this;removeItemAjax(t,"delete_bl_person",function(){e.deleteRow(t,e.tableData)})},deleteRow:function(e,t){this.tableData=t.filter(function(t){return t.id!==e})}}})),document.getElementById("datatable-places")&&(Vue.use(VueTables.ClientTable,!1,!1,"bootstrap4"),columns=["edit","city","country"],new Vue({el:"#datatable-places",data:{columns:columns,tableData:JSON.parse(document.querySelector("#places-data").innerHTML),options:{headings:{edit:"Akce"},skin:defaultTablesOptions.skin,sortable:removeElFromArr("edit",columns),filterable:removeElFromArr("edit",columns),sortIcon:defaultTablesOptions.sortIcon,texts:defaultTablesOptions.texts,rowClassCallback:function(t){return"row-"+t.id}}},methods:{deletePlace:function(t){var e=this;removeItemAjax(t,"delete_bl_place",function(){e.deleteRow(t,e.tableData)})},deleteRow:function(e,t){this.tableData=t.filter(function(t){return t.id!==e})}}}));